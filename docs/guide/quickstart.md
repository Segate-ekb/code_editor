# Быстрый старт

Минимальная интеграция редактора кода в управляемую форму 1С.

## Требования

- На форме: элемент типа `ПолеHTML` 
- События элемента: `ДокументСформирован`, `ПриНажатии`

## Шаг 1. Инициализация на сервере

В обработчике `ПриСозданииНаСервере`:

```bsl
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)

    конс_ПодключаемаяКонсольСервер.ИнициализироватьРедактор(
        ЭтотОбъект, УникальныйИдентификатор);

КонецПроцедуры
```


```bsl
конс_ПодключаемаяКонсольСервер.ИнициализироватьРедактор(
    ЭтотОбъект, УникальныйИдентификатор, "ПолеРедактора");
```

## Шаг 2. Подключение на клиенте

В обработчике `ПриОткрытии`:

```bsl
&НаКлиенте
Процедура ПриОткрытии(Отказ)

    конс_ПодключаемаяКонсольКлиент.ПодключитьРедактор(ЭтаФорма);

КонецПроцедуры
```

## Шаг 3. Обработка событий HTML-поля

Два обработчика на элементе `ПолеHTML`:

```bsl
&НаКлиенте
Процедура HTMLДокументСформирован(Элемент)

    конс_ПодключаемаяКонсольКлиент.ОбработчикДокументСформирован(ЭтаФорма);

КонецПроцедуры

&НаКлиенте
Процедура HTMLПриНажатии(Элемент, ДанныеСобытия, СтандартнаяОбработка)

    конс_ПодключаемаяКонсольКлиент.ОбработчикПриНажатии(ЭтаФорма, ДанныеСобытия);

КонецПроцедуры
```

> **Готово.** Это весь обязательный код. Редактор откроется с настройками по умолчанию: светлая тема, автодополнение, карта кода.

## Схема инициализации

```
ПриСозданииНаСервере
    └─ ИнициализироватьРедактор()
         ├─ Создаёт служебный реквизит конс_СтруктураПараметровРедактораКода
         ├─ Загружает исходники редактора из макета
         ├─ Собирает коллекцию общих модулей для автодополнения
         └─ Загружает настройки пользователя из хранилища

ПриОткрытии
    └─ ПодключитьРедактор()
         ├─ Распаковывает исходники Monaco во временный каталог
         └─ Устанавливает путь к index.html в ПолеHTML

HTMLДокументСформирован
    └─ ОбработчикДокументСформирован()
         ├─ Вызывает init() в JavaScript
         ├─ Применяет настройки (тема, шрифт, миникарта...)
         └─ Загружает метаданные для автодополнения

HTMLПриНажатии
    └─ ОбработчикПриНажатии()
         └─ Обрабатывает события редактора (изменение, клики по ссылкам, запросы метаданных)
```

## Варианты передачи параметров в `ИнициализироватьРедактор`

| Вариант | Пример |
|---------|--------|
| По умолчанию (поле `HTML`) | `ИнициализироватьРедактор(ЭтотОбъект, UUID)` |
| Имя поля строкой | `ИнициализироватьРедактор(ЭтотОбъект, UUID, "ПолеРедактора")` |
| Элемент формы | `ИнициализироватьРедактор(ЭтотОбъект, UUID, Элементы.ПолеРедактора)` |
| Структура с параметрами | `ИнициализироватьРедактор(ЭтотОбъект, UUID, Параметры)` |

Структура параметров:

```bsl
Параметры = Новый Структура;
Параметры.Вставить("ИмяПоляHTML", "ПолеРедактора");
Параметры.Вставить("Версия", "2.0");  // для кэширования исходников
Параметры.Вставить("ПереопределитьНастройки", Новый Структура);
Параметры.ПереопределитьНастройки.Вставить("Тема", "ТемнаяТема");
Параметры.ПереопределитьНастройки.Вставить("КартаКода", Ложь);
```
