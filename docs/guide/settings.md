# Настройки

## Общие настройки (хранилище)

Настройки хранятся в `ХранилищеОбщихНастроек` и применяются ко всем окнам редактора для данного пользователя. Пользователь может изменить их через форму настроек:

```bsl
конс_ПодключаемаяКонсольКлиент.ОткрытьНастройкиРедактора();
```

## Таблица настроек

| Ключ | Тип | По умолчанию | Описание |
|------|-----|-------------|----------|
| `Тема` | Строка | `"СветлаяТема"` | Тема оформления |
| `БыстрыеПодсказки` | Булево | `Истина` | Автодополнение при вводе |
| `КартаКода` | Булево | `Истина` | Миникарта справа |
| `ПробелыИТабуляции` | Булево | `Ложь` | Показывать непечатаемые символы |
| `СтрокаСостояния` | Булево | `Истина` | Строка состояния снизу |
| `ПутьКИсходникамКонфигурации` | Строка | `""` | Каталог с исходниками для загрузки модулей |
| `ПутьКШаблонамКода` | Строка | `""` | Путь к `.st`-файлу шаблонов |
| `ПоказыватьПеременные` | ПеречислениеСсылка | `ВТабло` | Режим: `ВТабло`, `ВПодсказках`, `НеОтображать` |
| `СохранятьКодПриВыполнении` | Булево | `Ложь` | Сохранять текст перед выполнением |
| `ЯзыкПодсказок` | Строка | `"ru"` | Язык подсказок: `"ru"` / `"en"` |

## Темы оформления

| Значение | Описание |
|----------|----------|
| `СветлаяТема` | Светлая (Monaco `bsl-white`) |
| `ТемнаяТема` | Тёмная (Monaco `bsl-dark`) |
| `СветлаяТемаПлюс` | Высокий контраст, светлая (`hc-light`) |
| `ТемнаяТемаПлюс` | Высокий контраст, тёмная (`hc-dark`) |

## Переопределение настроек при инициализации

Для конкретной формы можно переопределить любые настройки. Они будут иметь приоритет над общими настройками пользователя:

```bsl
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)

    Параметры = Новый Структура;
    Параметры.Вставить("ПереопределитьНастройки", Новый Структура);
    Параметры.ПереопределитьНастройки.Вставить("Тема", "ТемнаяТема");
    Параметры.ПереопределитьНастройки.Вставить("КартаКода", Ложь);
    Параметры.ПереопределитьНастройки.Вставить("СтрокаСостояния", Ложь);
    Параметры.ПереопределитьНастройки.Вставить("БыстрыеПодсказки", Ложь);

    конс_ПодключаемаяКонсольСервер.ИнициализироватьРедактор(
        ЭтотОбъект, УникальныйИдентификатор, Параметры);

КонецПроцедуры
```

## Применение настроек на лету

После инициализации можно менять настройки в любой момент:

```bsl
// Изменить тему
конс_ПодключаемаяКонсольКлиент.УстановитьТему(ЭтаФорма, "ТемнаяТема");

// Включить/выключить только чтение
конс_ПодключаемаяКонсольКлиент.УстановитьРежимТолькоЧтение(ЭтаФорма, Истина);

// Сменить язык редактора
конс_ПодключаемаяКонсольКлиент.УстановитьРежимЯзыка(ЭтаФорма, "bsl_query");

// Полная структура настроек
Настройки = Новый Структура;
Настройки.Вставить("Тема", "ТемнаяТемаПлюс");
Настройки.Вставить("КартаКода", Ложь);
конс_ПодключаемаяКонсольКлиент.ПрименитьНастройки(ЭтаФорма, Настройки);
```

## Работа с настройками на сервере

```bsl
// Получить текущие настройки
Настройки = конс_ПодключаемаяКонсольСервер.ПолучитьНастройкиИзХранилища();

// Изменить и сохранить
Настройки.Тема = "ТемнаяТема";
конс_ПодключаемаяКонсольСервер.СохранитьНастройкиВХранилище(Настройки);

// Получить настройки по умолчанию (без учёта сохранённых)
Умолчания = конс_ПодключаемаяКонсольСервер.НастройкиПоУмолчанию();
```

## Приоритет настроек

```
ПереопределитьНастройки (при инициализации)
    ↓ перекрывает
Настройки пользователя (из ХранилищеОбщихНастроек)
    ↓ перекрывает
НастройкиПоУмолчанию()
```

## Режимы языка

| Режим | Вызов |
|-------|-------|
| BSL (1С) | `УстановитьРежимЯзыка(Форма, "bsl")` |
| Запрос 1С | `УстановитьРежимЯзыка(Форма, "bsl_query")` |
| Запрос СКД | `УстановитьРежимЯзыка(Форма, "dcs_query")` |
| JSON | `УстановитьРежимЯзыка(Форма, "json")` |
| XML | `УстановитьРежимЯзыка(Форма, "xml")` |
| YAML | `УстановитьРежимЯзыка(Форма, "yaml")` |
