# Сниппеты (шаблоны кода)

Сниппеты — это быстрые шаблоны кода, которые разворачиваются при нажатии Tab. Они ускоряют написание типовых конструкций.

## Быстрый пример

```bsl
// В ПриСозданииНаСервере
конс_ПодключаемаяКонсольСервер.ДобавитьСниппет(ЭтотОбъект,
    "Для",
    "Для ${1:Индекс} = ${2:0} По ${3:Количество} - 1 Цикл
    |	${0}
    |КонецЦикла;",
    "Цикл Для с числовым счётчиком");

// В HTMLДокументСформирован
конс_ПодключаемаяКонсольКлиент.ЗагрузитьПользовательскийКонтекст(ЭтаФорма);
```

После этого при вводе `Для` и нажатии Tab развернётся шаблон цикла.

## Синтаксис сниппетов

### Точки табуляции

Точки табуляции определяют места, где курсор остановится при переходе по Tab:

| Синтаксис | Описание |
|-----------|----------|
| `${1}` | Первая точка табуляции |
| `${2}` | Вторая точка табуляции |
| `${0}` | Финальная позиция курсора |
| `${1:значение}` | Точка с значением по умолчанию |

### Порядок обхода

```
${1}  →  ${2}  →  ${3}  →  ...  →  ${0}
```

Курсор перемещается по Tab от `${1}` до `${0}`, который всегда последний.

### Значения по умолчанию

```
${1:ИмяПеременной}   // Текст "ИмяПеременной" будет выделен для замены
```

### Перенос строк

Используйте `|` в начале строки для правильных переносов:

```bsl
"Если ${1:Условие} Тогда
|	${0}
|КонецЕсли;"
```

## Добавление сниппетов

### Метод ДобавитьСниппет

```bsl
конс_ПодключаемаяКонсольСервер.ДобавитьСниппет(Форма, Префикс, ТелоСниппета, Описание)
```

| Параметр | Тип | Описание |
|----------|-----|----------|
| `Форма` | ФормаКлиентскогоПриложения | Форма с редактором |
| `Префикс` | Строка | Текст для активации сниппета |
| `ТелоСниппета` | Строка | Шаблон кода с точками табуляции |
| `Описание` | Строка | Описание в автодополнении |

## Примеры сниппетов

### Условные конструкции

```bsl
// Если-Тогда
конс_ПодключаемаяКонсольСервер.ДобавитьСниппет(ЭтотОбъект,
    "Если",
    "Если ${1:Условие} Тогда
    |	${0}
    |КонецЕсли;",
    "Условный оператор");

// Если-Тогда-Иначе
конс_ПодключаемаяКонсольСервер.ДобавитьСниппет(ЭтотОбъект,
    "ЕслиИначе",
    "Если ${1:Условие} Тогда
    |	${2}
    |Иначе
    |	${0}
    |КонецЕсли;",
    "Условный оператор с веткой Иначе");

// Тернарный оператор
конс_ПодключаемаяКонсольСервер.ДобавитьСниппет(ЭтотОбъект,
    "Выбор",
    "?(${1:Условие}, ${2:ЕслиИстина}, ${0:ЕслиЛожь})",
    "Тернарный оператор");
```

### Циклы

```bsl
// Цикл Для
конс_ПодключаемаяКонсольСервер.ДобавитьСниппет(ЭтотОбъект,
    "Для",
    "Для ${1:Индекс} = ${2:0} По ${3:Количество} - 1 Цикл
    |	${0}
    |КонецЦикла;",
    "Цикл с числовым счётчиком");

// Цикл Для Каждого
конс_ПодключаемаяКонсольСервер.ДобавитьСниппет(ЭтотОбъект,
    "ДляКаждого",
    "Для Каждого ${1:Элемент} Из ${2:Коллекция} Цикл
    |	${0}
    |КонецЦикла;",
    "Цикл обхода коллекции");

// Цикл Пока
конс_ПодключаемаяКонсольСервер.ДобавитьСниппет(ЭтотОбъект,
    "Пока",
    "Пока ${1:Условие} Цикл
    |	${0}
    |КонецЦикла;",
    "Цикл с предусловием");
```

### Обработка ошибок

```bsl
// Попытка
конс_ПодключаемаяКонсольСервер.ДобавитьСниппет(ЭтотОбъект,
    "Попытка",
    "Попытка
    |	${1}
    |Исключение
    |	${0}
    |КонецПопытки;",
    "Блок обработки исключений");

// Попытка с логированием
конс_ПодключаемаяКонсольСервер.ДобавитьСниппет(ЭтотОбъект,
    "ПопыткаЛог",
    "Попытка
    |	${1}
    |Исключение
    |	ОписаниеОшибки = ОписаниеОшибки();
    |	// TODO: Обработать ошибку
    |	${0}
    |КонецПопытки;",
    "Попытка с получением описания ошибки");
```

### Процедуры и функции

```bsl
// Процедура
конс_ПодключаемаяКонсольСервер.ДобавитьСниппет(ЭтотОбъект,
    "Проц",
    "Процедура ${1:ИмяПроцедуры}(${2:Параметры})
    |	
    |	${0}
    |	
    |КонецПроцедуры",
    "Объявление процедуры");

// Функция
конс_ПодключаемаяКонсольСервер.ДобавитьСниппет(ЭтотОбъект,
    "Функ",
    "Функция ${1:ИмяФункции}(${2:Параметры})
    |	
    |	${3:Результат} = ${0};
    |	
    |	Возврат ${3:Результат};
    |	
    |КонецФункции",
    "Объявление функции");
```

### Работа с запросами

```bsl
// Простой запрос
конс_ПодключаемаяКонсольСервер.ДобавитьСниппет(ЭтотОбъект,
    "Запрос",
    "Запрос = Новый Запрос;
    |Запрос.Текст =
    |	""ВЫБРАТЬ
    |	|	${1:Поля}
    |	|ИЗ
    |	|	${2:Таблица} КАК ${3:Таблица}"";
    |
    |Результат = Запрос.Выполнить();
    |${0}",
    "Создание и выполнение запроса");

// Запрос с параметрами
конс_ПодключаемаяКонсольСервер.ДобавитьСниппет(ЭтотОбъект,
    "ЗапросПарам",
    "Запрос = Новый Запрос;
    |Запрос.Текст =
    |	""ВЫБРАТЬ
    |	|	${1:Поля}
    |	|ИЗ
    |	|	${2:Таблица} КАК ${3:Таблица}
    |	|ГДЕ
    |	|	${4:Условие} = &${5:Параметр}"";
    |
    |Запрос.УстановитьПараметр(""${5:Параметр}"", ${6:Значение});
    |Результат = Запрос.Выполнить();
    |${0}",
    "Запрос с параметром");

// Обход результата запроса
конс_ПодключаемаяКонсольСервер.ДобавитьСниппет(ЭтотОбъект,
    "ВыборкаЗапроса",
    "Выборка = Результат.Выбрать();
    |Пока Выборка.Следующий() Цикл
    |	${0}
    |КонецЦикла;",
    "Обход результата запроса");
```

### Вывод и отладка

```bsl
// Сообщение
конс_ПодключаемаяКонсольСервер.ДобавитьСниппет(ЭтотОбъект,
    "Сооб",
    "Сообщить(${0:""Текст""});",
    "Вывод сообщения");

// Сообщение с форматом
конс_ПодключаемаяКонсольСервер.ДобавитьСниппет(ЭтотОбъект,
    "СообФ",
    "Сообщить(СтрШаблон(""${1:Шаблон %1}"", ${0:Параметр}));",
    "Вывод форматированного сообщения");
```

## Полный пример

```bsl
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
    
    конс_ПодключаемаяКонсольСервер.ИнициализироватьРедактор(ЭтотОбъект, УникальныйИдентификатор);
    
    ДобавитьСниппеты();
    
КонецПроцедуры

&НаСервере
Процедура ДобавитьСниппеты()
    
    // Условия
    конс_ПодключаемаяКонсольСервер.ДобавитьСниппет(ЭтотОбъект,
        "Если",
        "Если ${1:Условие} Тогда
        |	${0}
        |КонецЕсли;",
        "Условный оператор");
    
    // Циклы
    конс_ПодключаемаяКонсольСервер.ДобавитьСниппет(ЭтотОбъект,
        "ДляКаждого",
        "Для Каждого ${1:Элемент} Из ${2:Коллекция} Цикл
        |	${0}
        |КонецЦикла;",
        "Цикл обхода");
    
    // Запросы
    конс_ПодключаемаяКонсольСервер.ДобавитьСниппет(ЭтотОбъект,
        "Запрос",
        "Запрос = Новый Запрос;
        |Запрос.Текст =
        |	""ВЫБРАТЬ
        |	|	${1:*}
        |	|ИЗ
        |	|	${2:Таблица}"";
        |Результат = Запрос.Выполнить();
        |${0}",
        "Новый запрос");
    
КонецПроцедуры

&НаКлиенте
Процедура HTMLДокументСформирован(Элемент)
    
    конс_ПодключаемаяКонсольКлиент.ОбработчикДокументСформирован(ЭтаФорма);
    конс_ПодключаемаяКонсольКлиент.ЗагрузитьПользовательскийКонтекст(ЭтаФорма);
    
КонецПроцедуры
```

## Загрузка из файла шаблонов

Можно загрузить сниппеты из файла шаблонов 1С (.st):

```bsl
конс_ПодключаемаяКонсольКлиент.ЗагрузитьСниппетыИзФайла(ЭтаФорма, "C:\Шаблоны\МоиШаблоны.st");
```

## Загрузка из JSON

Можно загрузить сниппеты в формате JSON:

```bsl
JSONСниппетов = "{
    |""snippets"": {
    |   ""МойСниппет"": {
    |       ""prefix"": ""мой"",
    |       ""body"": ""Сообщить(\""${0:текст}\"");"",
    |       ""description"": ""Мой сниппет""
    |   }
    |}
|}";

конс_ПодключаемаяКонсольКлиент.ЗагрузитьСниппетыИзJSON(ЭтаФорма, JSONСниппетов);
```

## Как работают сниппеты

1. Начните вводить префикс сниппета (например, `Для`)
2. В списке автодополнения появится сниппет с иконкой
3. Выберите сниппет и нажмите Tab или Enter
4. Шаблон развернётся, курсор встанет на первую точку табуляции
5. Введите значение и нажмите Tab для перехода к следующей точке
6. После последней точки курсор перейдёт к `${0}`

## См. также

- [Добавление переменных](variables.md)
- [Добавление функций](functions.md)
- [Настройки редактора](settings.md)
